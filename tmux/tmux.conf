unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Pane navigation with prefix
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Clear scrollback history (Ctrl-k, no prefix needed)
bind -n C-k clear-history

setw -g mode-keys vi

# Vi-style copy mode (Ctrl-x to enter, v to select, y to yank, q to exit)
bind-key -n C-x copy-mode
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe "pbcopy"
bind-key -T copy-mode-vi Y send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "pbcopy"
unbind-key -T copy-mode-vi i
bind-key -T copy-mode-vi q send-keys -X cancel

# Mouse support for scrolling and copy
set -g mouse on

# Scrollback buffer - near unlimited (1 million lines)
set -g history-limit 10000

# (optional) splits
bind | split-window -h
bind - split-window -v

# Quick splits without prefix
bind-key -n M-| split-window -h
bind-key -n M-- split-window -v

# Quick pane close
bind-key -n M-x kill-pane

# Window management
bind-key n new-window
bind-key ] next-window
bind-key [ previous-window
bind-key x kill-window
bind-key r command-prompt -I "#W" "rename-window '%%'"

# Dump current pane to file in current directory
bind-key D run-shell "tmux capture-pane -pS -100000 > '#{pane_current_path}/tmux_dump.log' && tmux display-message 'Pane saved to #{pane_current_path}/tmux_dump.log'"

# ============================================
# TPM Plugin Manager
# ============================================
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
#
# # Better copy/paste with system clipboard
# set -g @plugin 'tmux-plugins/tmux-yank'
#
# # Fuzzy finder for URLs
# set -g @plugin 'wfxr/tmux-fzf-url'
#
# # Quick text selection (like hop.nvim)
# set -g @plugin 'fcsonline/tmux-thumbs'
#
# # Session save/restore
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-continuum'
#
# # Better status line
# set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
#
# # ============================================
# # Plugin Configuration
# # ============================================
#
# # tmux-fzf-url: Open URLs with prefix + u
# set -g @fzf-url-bind 'u'
#
# # tmux-thumbs: Quick selection with prefix + f
# set -g @thumbs-key f
#
# # tmux-continuum: Auto-save sessions every 15 minutes
# set -g @continuum-restore 'on'
# set -g @continuum-save-interval '15'
#
# # tmux-resurrect: Save vim/nvim sessions too
# set -g @resurrect-strategy-nvim 'session'
#
# # Initialize TPM (keep this at the very bottom)
# run '~/.tmux/plugins/tpm/tpm'
